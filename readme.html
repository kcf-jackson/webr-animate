<h1 id="webr-animate">webr-animate</h1>
<p>This is an experiment to manually port the <a href="https://github.com/kcf-jackson/animate">animate</a> R package to <a href="https://github.com/r-wasm/webr/">webR</a>.</p>
<p>The goal is to have a (partially) working version of the <code>animate</code> package in the browser until the original package can be compiled natively to WebAssembly and loaded by webR. This is a proof of concept, and not intended for production use.</p>
<p>The experiment intends to show how much flexibility and fun one can have when you can use R in the browser!</p>
<h2 id="two-examples---sokoban-and-2048">Two examples - Sokoban and 2048</h2>
<p>Play <a href="">live demo</a> here. - Click the folder button, select the game from the drop-down menu and source <code>main.R</code> to start the game. - The app takes about 20-40 seconds to load for the first time. - It is highlhy recommended to refresh the app before switching to a different example.</p>
<p><strong>Sokoban</strong></p>
<video controls>
<source src="./examples/samples/sokoban/sokoban_screencast.mp4" type="video/mp4" width="480px" height="480px">
<p>Your browser does not support the video tag. </video></p>
<figure>
<img src="./examples/samples/2048/2048_screencast.gif" alt="" /><figcaption>2048</figcaption>
</figure>
<h2 id="notes">Notes</h2>
<ol type="1">
<li><p><strong>Mouse and Keyboard control.</strong> The variable <code>io</code> is reserved for the webr-animate package to capture mouse and keyboard events. The variables get updated whenever a registered event gets triggered. Here is a simple example:</p>
<p>#### Mouse events</p>
<pre><code># Setup device
attach(device)
new(400, 400, id = &#39;svg-1&#39;, root = &#39;#plot&#39;)  # there is a div with id &#39;plot&#39; in the HTML

# Create the base plot
par(xlim = c(0, 10), ylim = c(0, 10))  # use static range
plot(1:10, 1:10, id = 1:10)

# Update plot when clicked
event(&#39;#plot&#39;, &#39;click&#39;, function(io) {  # the `io` argument must be present
    print(io)   # inspect the event variable
    points(1:10, sample(10), id = 1:10, transition = TRUE)
})</code></pre>
<p>The first argument of <code>event</code> takes a CSS selector, and the second argument takes the event type (e.g. see the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element#mouse_events">Mouse events</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element#keyboard_events">Keyboard events</a>). The third argument is a function that takes the <code>io</code> variable as its argument and performs the desired action.</p>
<p>#### Keyboard events</p>
<p>Using the same example, you can listen for the “Enter” key press event instead of the mouse click event:</p>
<pre><code># Setup device
attach(device)
new(400, 400, id = &#39;svg-1&#39;, root = &#39;#plot&#39;)  # there is a div with id &#39;plot&#39; in the HTML

# Create the base plot
par(xlim = c(0, 10), ylim = c(0, 10))  # use static range
plot(1:10, 1:10, id = 1:10)

# Update plot when &quot;Enter&quot; is pressed
event(&#39;#plot&#39;, &#39;keypress&#39;, function(io) {  # the `io` argument must be present
    if (io$event$key == &#39;Enter&#39;) {
        points(1:10, sample(10), id = 1:10, transition = TRUE)
    }
})</code></pre></li>
<li><p><strong>Differences between <code>animate</code> and <code>webr-animate</code>.</strong> In <code>webr-animate</code>, you initialise the device with: <code>device$new(width = 600, height = 600, id = "svg-1", root = "#plot")     attach(device)</code></p>
<p>unlike the case in <code>animate</code>: <code>device &lt;- animate$new(width = 600, height = 600, id = "svg-1", root = "#plot")  attach(device)</code></p>
<p><strong>Remember that the <code>device</code> and <code>io</code> variables are reserved</strong>, so please do not write to them.</p></li>
</ol>
